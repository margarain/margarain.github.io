<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Dog Breed Details</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: linear-gradient(to right, #ffb6c1, #c2e9fb); min-height: 100vh; }
        .breed-image { width: 100%; height: 250px; object-fit: cover; border-radius: 10px; }
        .breed-title { text-transform: capitalize; font-weight: 300; letter-spacing: 1px; }
        .info-card { background-color: rgba(255, 255, 255, 0.8); backdrop-filter: blur(5px); }
        .info-card .list-group-item { background-color: transparent; border-color: rgba(0,0,0,0.08); }
        .info-card .list-group-item strong { color: #333; }
    </style>
</head>
<body>

<div class="container my-5">
    
    <div id="loading-state" class="text-center">
        <h1 id="breed-title" class="mb-4 breed-title">Loading Breed...</h1>
        <div class="spinner-border text-dark" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>

    <div id="content-area" class="row g-4 d-none">
        <div class="col-lg-8">
            <h2 class="h4 mb-3">Image Gallery</h2>
            <div class="row g-3" id="image-gallery"></div>
        </div>
        <div class="col-lg-4">
            <h2 class="h4 mb-3">Breed Information</h2>
            <div class="card p-3 info-card shadow-sm">
                <ul class="list-group list-group-flush" id="breed-info-list"></ul>
            </div>
        </div>
    </div>

    <div id="error-message" class="alert alert-danger mt-4 d-none"></div>
    
    <div class="text-center">
      <a href="index.html" class="btn btn-outline-dark mt-5">< Back to Full Gallery</a>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const apiKey = 'YdFwBH95TdmqugO34yZZSQ==0vAdGEoIdNXJh6pL';

    const breedTitle = document.getElementById('breed-title');
    const imageGallery = document.getElementById('image-gallery');
    const breedInfoList = document.getElementById('breed-info-list');
    const loadingState = document.getElementById('loading-state');
    const contentArea = document.getElementById('content-area');
    const errorMessage = document.getElementById('error-message');

    if (apiKey === 'YOUR_API_NINJAS_KEY_HERE') {
        alert('Please open view.html and add your API-Ninjas key!');
        return;
    }

    const urlParams = new URLSearchParams(window.location.search);
    const breedFromUrl = urlParams.get('breed');

    const showError = (message) => {
        loadingState.style.display = 'none';
        errorMessage.textContent = message;
        errorMessage.classList.remove('d-none');
    };

    if (!breedFromUrl) {
        showError('No breed specified. Please go back to the gallery and select a dog.');
        return;
    }
    
    const displayBreedName = breedFromUrl.replace(/\//g, ' ');
    breedTitle.textContent = displayBreedName;

    const fetchBreedDetails = async () => {
        try {
            const searchQuery = breedFromUrl.split('/').pop();

            const dataPromise = fetch(`https://api.api-ninjas.com/v1/dogs?name=${searchQuery}`, {
                headers: { 'X-Api-Key': apiKey }
            });
            const imagesPromise = fetch(`https://dog.ceo/api/breed/${breedFromUrl}/images/random/8`);

            const [dataResponse, imagesResponse] = await Promise.all([dataPromise, imagesPromise]);

            if (!dataResponse.ok || !imagesResponse.ok) {
                throw new Error('Failed to fetch data from one or more APIs.');
            }

            const dogDataArray = await dataResponse.json();
            const imagesData = await imagesResponse.json();

            if (dogDataArray.length === 0) {
                throw new Error(`No detailed data found for "${displayBreedName}". The API may not recognize this specific breed.`);
            }

            const dogData = dogDataArray[0];

            const lifeExpectancy = `${dogData.min_life_expectancy} - ${dogData.max_life_expectancy} years`;

            breedInfoList.innerHTML = `
                <li class="list-group-item"><strong>Name:</strong> ${dogData.name || 'Not available'}</li>
                <li class="list-group-item"><strong>Temperament:</strong> ${dogData.temperament || 'Not available'}</li>
                <li class="list-group-item"><strong>Origin:</strong> ${dogData.origin || 'Not available'}</li>
                <li class="list-group-item"><strong>Life Expectancy:</strong> ${lifeExpectancy}</li>
                <li class="list-group-item"><strong>Good with Children:</strong> ${"‚≠ê".repeat(dogData.good_with_children || 0)}</li>
                <li class="list-group-item"><strong>Energy Level:</strong> ${"‚ö°".repeat(dogData.energy || 0)}</li>
                <li class="list-group-item"><strong>Shedding:</strong> ${"üíß".repeat(dogData.shedding || 0)}</li>
                <li class="list-group-item"><strong>Grooming Needs:</strong> ${"‚úÇÔ∏è".repeat(dogData.grooming || 0)}</li>
            `;

            if (imagesData.status === 'success') {
                imageGallery.innerHTML = '';
                imagesData.message.forEach(imageUrl => {
                    const col = `<div class="col-6 col-md-4"><img src="${imageUrl}" class="img-fluid breed-image shadow-sm" alt="${displayBreedName}"></div>`;
                    imageGallery.innerHTML += col;
                });
            }

            loadingState.style.display = 'none';
            contentArea.classList.remove('d-none');

        } catch (error) {
            console.error('Error fetching breed details:', error);
            showError(error.message);
        }
    };

    fetchBreedDetails();
});
</script>

</body>
</html>